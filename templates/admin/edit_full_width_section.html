{% extends "admin/base_admin.html" %}

{% block title %}Edit Full-Width Section - Admin{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="max-w-2xl mx-auto">
        <div class="flex items-center mb-6">
            <a href="{{ url_for('admin.admin_full_width_sections') }}" 
               class="text-primary hover:text-primary-dark mr-4">
                <i class="fas fa-arrow-left text-xl"></i>
            </a>
            <h1 class="text-3xl font-bold text-white">Edit Full-Width Section</h1>
        </div>

        <div class="bg-dark border border-gray-700 rounded-lg p-6">
            <form method="POST" enctype="multipart/form-data" class="space-y-6">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                
                <!-- Current Image Preview -->
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">
                        Current Image
                    </label>
                    <div class="relative">
                        <img src="{{ section.image_url }}" 
                             alt="{{ section.title or 'Full-width section' }}" 
                             class="w-full h-48 object-cover rounded-lg border border-gray-600">
                        <div class="absolute top-2 right-2">
                            {% if section.is_active %}
                                <span class="bg-green-500 text-white px-2 py-1 rounded-full text-xs">Active</span>
                            {% else %}
                                <span class="bg-red-500 text-white px-2 py-1 rounded-full text-xs">Inactive</span>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Title -->
                <div>
                    <label for="title" class="block text-sm font-medium text-gray-300 mb-2">
                        Section Title (Optional)
                    </label>
                    <input type="text" id="title" name="title" value="{{ section.title or '' }}"
                           class="w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md text-white focus:outline-none focus:border-primary"
                           placeholder="Enter section title">
                </div>

                <!-- New Image Upload -->
                <div>
                    <label for="image" class="block text-sm font-medium text-gray-300 mb-2">
                        Replace Image (Optional)
                    </label>
                    <input type="file" id="image" name="image" accept="image/*"
                           class="w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md text-white focus:outline-none focus:border-primary">
                    <p class="text-sm text-gray-400 mt-1">
                        Leave empty to keep current image. Supported formats: PNG, JPG, JPEG, GIF, WEBP.
                    </p>
                </div>

                <!-- Order -->
                <div>
                    <label for="order" class="block text-sm font-medium text-gray-300 mb-2">
                        Display Order
                    </label>
                    <input type="number" id="order" name="order" value="{{ section.order }}" min="0"
                           class="w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md text-white focus:outline-none focus:border-primary">
                    <p class="text-sm text-gray-400 mt-1">
                        Lower numbers appear first. Use 0 for default order.
                    </p>
                </div>

                <!-- Button Settings -->
                <div class="border border-gray-700 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-white mb-4">Button Settings</h3>
                    
                    <div class="space-y-4">
                        <!-- Show Button Toggle -->
                        <div class="flex items-center">
                            <input type="checkbox" id="show_button" name="show_button" 
                                   {% if section.show_button %}checked{% endif %}
                                   class="w-4 h-4 text-primary bg-gray-800 border-gray-600 rounded focus:ring-primary focus:ring-2">
                            <label for="show_button" class="ml-2 text-sm text-gray-300">
                                Show button on this section
                            </label>
                        </div>

                        <!-- Button Text -->
                        <div>
                            <label for="button_text" class="block text-sm font-medium text-gray-300 mb-2">
                                Button Text
                            </label>
                            <input type="text" id="button_text" name="button_text" 
                                   value="{{ section.button_text or '' }}"
                                   class="w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md text-white focus:outline-none focus:border-primary"
                                   placeholder="e.g., Learn More, Shop Now, Get Started">
                        </div>

                        <!-- Button URL -->
                        <div>
                            <label for="button_url" class="block text-sm font-medium text-gray-300 mb-2">
                                Button URL
                            </label>
                            <input type="url" id="button_url" name="button_url" 
                                   value="{{ section.button_url or '' }}"
                                   class="w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md text-white focus:outline-none focus:border-primary"
                                   placeholder="https://example.com">
                        </div>
                    </div>
                </div>

                <!-- Image Link Settings -->
                <div class="border border-gray-700 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-white mb-4">Image Link Settings</h3>
                    
                    <div>
                        <label for="image_link_url" class="block text-sm font-medium text-gray-300 mb-2">
                            Make Image Clickable (Optional)
                        </label>
                        <input type="url" id="image_link_url" name="image_link_url" 
                               value="{{ section.image_link_url or '' }}"
                               class="w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md text-white focus:outline-none focus:border-primary"
                               placeholder="https://example.com">
                        <p class="text-sm text-gray-400 mt-1">
                            If provided, the entire image will be clickable and link to this URL.
                        </p>
                    </div>
                </div>

                <!-- Active Status -->
                <div class="flex items-center">
                    <input type="checkbox" id="is_active" name="is_active" 
                           {% if section.is_active %}checked{% endif %}
                           class="w-4 h-4 text-primary bg-gray-800 border-gray-600 rounded focus:ring-primary focus:ring-2">
                    <label for="is_active" class="ml-2 text-sm text-gray-300">
                        Active (visible on website)
                    </label>
                </div>

                <!-- Submit Buttons -->
                <div class="flex space-x-4 pt-6">
                    <button type="submit" 
                            class="bg-primary hover:bg-primary-dark text-white px-6 py-2 rounded-md transition-colors duration-300">
                        <i class="fas fa-save mr-2"></i>Update Section
                    </button>
                    <a href="{{ url_for('admin.admin_full_width_sections') }}" 
                       class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-2 rounded-md transition-colors duration-300">
                        Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
// Show/hide button fields based on checkbox
document.getElementById('show_button').addEventListener('change', function() {
    const buttonFields = document.querySelectorAll('#button_text, #button_url');
    buttonFields.forEach(field => {
        field.disabled = !this.checked;
        if (!this.checked) {
            field.value = '';
        }
    });
});

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    const showButton = document.getElementById('show_button');
    const buttonFields = document.querySelectorAll('#button_text, #button_url');
    buttonFields.forEach(field => {
        field.disabled = !showButton.checked;
    });
});
</script>
{% endblock %} 